{% assign nav_pages = site.pages | where_exp: "p", "p.nav_order" | sort: "nav_order" %}

<nav class="main-nav">
    <div class="nav-brand">
        <a href="{{ '/' | relative_url }}">
            <span class="logo">⚡</span>
            FilterQL
        </a>
    </div>
    
    <div class="nav-toggle" id="nav-toggle">
        <span></span>
        <span></span>
        <span></span>
    </div>
    
    <ul class="nav-menu" id="nav-menu">
        <li class="nav-item">
            <a href="{{ '/' | relative_url }}" class="nav-link {% if page.url == '/' %}active{% endif %}">
                🏠 Accueil
            </a>
        </li>
        
        <!-- Documentation principale -->
        {% assign doc_pages = nav_pages | where_exp: "p", "p.category == 'docs'" %}
        {% if doc_pages.size > 0 %}
        <li class="nav-item dropdown">
            <a href="#" class="nav-link dropdown-toggle">
                📚 Documentation
            </a>
            <ul class="dropdown-menu">
                {% for doc in doc_pages %}
                <li>
                    <a href="{{ doc.url | relative_url }}" class="dropdown-link {% if page.url == doc.url %}active{% endif %}">
                        {{ doc.title }}
                    </a>
                </li>
                {% endfor %}
            </ul>
        </li>
        {% endif %}
        
        <!-- Guides -->
        {% assign guide_pages = nav_pages | where_exp: "p", "p.category == 'guides'" %}
        {% if guide_pages.size > 0 %}
        <li class="nav-item dropdown">
            <a href="#" class="nav-link dropdown-toggle">
                🎯 Guides
            </a>
            <ul class="dropdown-menu">
                {% for guide in guide_pages %}
                <li>
                    <a href="{{ guide.url | relative_url }}" class="dropdown-link {% if page.url == guide.url %}active{% endif %}">
                        {{ guide.title }}
                    </a>
                </li>
                {% endfor %}
            </ul>
        </li>
        {% endif %}
        
        <!-- API Reference -->
        {% assign api_pages = nav_pages | where_exp: "p", "p.category == 'api'" %}
        {% if api_pages.size > 0 %}
        <li class="nav-item dropdown">
            <a href="#" class="nav-link dropdown-toggle">
                🔧 API
            </a>
            <ul class="dropdown-menu">
                {% for api in api_pages %}
                <li>
                    <a href="{{ api.url | relative_url }}" class="dropdown-link {% if page.url == api.url %}active{% endif %}">
                        {{ api.title }}
                    </a>
                </li>
                {% endfor %}
            </ul>
        </li>
        {% endif %}
        
        <!-- Exemples -->
        {% assign example_pages = nav_pages | where_exp: "p", "p.category == 'examples'" %}
        {% if example_pages.size > 0 %}
        <li class="nav-item">
            <a href="{{ '/examples/' | relative_url }}" class="nav-link {% if page.url contains '/examples/' %}active{% endif %}">
                💡 Exemples
            </a>
        </li>
        {% endif %}
        
        <!-- GitHub -->
        <li class="nav-item">
            <a href="https://github.com/cyfko/filter-build" target="_blank" class="nav-link external">
                <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                    <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"/>
                </svg>
                GitHub
            </a>
        </li>
    </ul>
</nav>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const navToggle = document.getElementById('nav-toggle');
    const navMenu = document.getElementById('nav-menu');
    
    if (navToggle && navMenu) {
        navToggle.addEventListener('click', function() {
            navToggle.classList.toggle('active');
            navMenu.classList.toggle('active');
        });
    }
    
    // Close mobile menu when clicking on a link
    const navLinks = document.querySelectorAll('.nav-link');
    navLinks.forEach(link => {
        link.addEventListener('click', () => {
            navToggle.classList.remove('active');
            navMenu.classList.remove('active');
        });
    });
});
</script>